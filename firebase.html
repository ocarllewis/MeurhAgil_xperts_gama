<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>Form</title>

<!-- Firebase App is always required and must be first -->
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-app.js"></script>

<!-- Add additional services that you want to use -->
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-messaging.js"></script>
<script src="https://www.gstatic.com/firebasejs/5.8.4/firebase-functions.js"></script>


<script src="https://www.gstatic.com/firebasejs/5.9.4/firebase.js"></script>
<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyAVstfh6NuexP9ycz52QTx-LVykiEuJGhk",
    authDomain: "meurhagil-e8c78.firebaseapp.com",
    databaseURL: "https://meurhagil-e8c78.firebaseio.com",
    projectId: "meurhagil-e8c78",
    storageBucket: "meurhagil-e8c78.appspot.com",
    messagingSenderId: "316155272451"
  };



app = firebase.initializeApp(config);

db=app.firestore()

window.addEventListener('load', function(){
    let f = document.querySelector ('form') 
     function saveuser(name,email,date, ){
        
        db.collection("users").add({
        
        name:name, email:email, date:date,
        
        
        })
        .then(function(docRef) {
            alert('Salvo Com Sucesso')
            f.elements['name'].value ="";
             f.elements['email'].value ="";
             
        })
        .catch(function(error) {
            console.error("Error adding document: ", error);
        });
        
        
        }


f.addEventListener('submit', function(e){
let nome= f.elements['name'].value 
let email= f.elements['email'].value 
let date = completeDate();
// let ip = getIp();

saveuser(nome,email,date)
e.preventDefault();
console.log(e);
})


});


function completeDate () {
    now = new Date();
    year = "" + now.getFullYear();
    month = "" + (now.getMonth() + 1); if (month.length == 1) { month = "0" + month; }
    day = "" + now.getDate(); if (day.length == 1) { day = "0" + day; }
    hour = "" + now.getHours(); if (hour.length == 1) { hour = "0" + hour; }
    minute = "" + now.getMinutes(); if (minute.length == 1) { minute = "0" + minute; }
    second = "" + now.getSeconds(); if (second.length == 1) { second = "0" + second; }
    return year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second;
  }




    function getIp(callback)
{
    function response(s)
    {
        callback(window.userip);

        s.onload = s.onerror = null;
        document.body.removeChild(s);
    }

    function trigger()
    {
        window.userip = false;

        var s = document.createElement("script");
        s.async = true;
        s.onload = function() {
            response(s);
        };
        s.onerror = function() {
            response(s);
        };

        s.src = "https://l2.io/ip.js?var=userip";
        document.body.appendChild(s);
    }

    if (/^(interactive|complete)$/i.test(document.readyState)) {
        trigger();
    } else {
        document.addEventListener('DOMContentLoaded', trigger);
    }


}

 getIp(function (ip) { 
     console.log(ip); 
     
     
     });

 



</script>
 
</head>
<body>
<form>


    <input name="name" placeholder=" Nome Completo" type="text" required/>
    <input name="email" placeholder="E-mail" type="email" required/>
     <input type="submit" value="Enviar" />

</form>







</body>



</html>